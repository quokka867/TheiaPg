#include "LinkHeader.h"

CONST UCHAR _25h2_w11_HandlerVsrKiExecuteAllDpcs[] =
{
  0x4c,0x8d, 0x80, 0x2c, 0x01, 0x00, 0x00, // lea     r8, [rax+12Ch]
  0x4f, 0x8d, 0x04, 0x40,                  // lea     r8, [r8+r8*2]
  0x49, 0xc1, 0xe0, 0x04                   // shl     r8, 4
};
CONST UCHAR _25h2_w11_KiExecuteAllDpcs_SIG[] = ///< For hook.
{
  0x4c, 0x8d, 0x80, 0x2c, 0x01, 0x00, 0x00, // lea     r8, [rax+12Ch]
  0x4f, 0x8d, 0x04, 0x40,                   // lea     r8, [r8+r8*2]
  0x49, 0xc1, 0xe0, 0x04                    // shl     r8, 4
};
CONST UCHAR _25h2_w11_KiExecuteAllDpcs_MASK[] = { "xxxxxxxxxxxxxxx" };


CONST UCHAR _25h2_w11_HandlerVsrKiRetireDpcList[] =
{
  0x48, 0x8b, 0xd9,                         // mov     rbx, rcx
  0x48, 0x89, 0x4d, 0xb0,                   // mov     qword ptr[rbp - 50h], rcx
  0x48, 0x8d, 0x4d, 0xc4,                   // lea     rcx,[rbp - 3Ch]
  0x33, 0xd2                                // xor     edx, edx
};
CONST UCHAR _25h2_w11_KiRetireDpcList_SIG[] = ///< For hook.
{
  0x48, 0x8b, 0xd9,                         // mov     rbx, rcx           
  0x48, 0x89, 0x4d, 0xb0,                   // mov     qword ptr[rbp - 50h], rcx
  0x48, 0x8d, 0x4d, 0xc4,                   // lea     rcx,[rbp - 3Ch]
  0x33, 0xd2                                // xor     edx, edx
};
CONST UCHAR _25h2_w11_KiRetireDpcList_MASK[] = { "xxxxxxxxxxxxx" };


CONST UCHAR _25h2_w11_Handler_KiDeliverApc[] =
{
  0x45, 0x33, 0xdb,                         // xor     r11d, r11d
  0x49, 0x8b, 0xf8,					        // mov     rdi, r8
  0x4c, 0x89, 0x5d, 0xe0,			        // mov     qword ptr [rbp - 20h], r11
  0x44, 0x0f, 0xb6, 0xe9				    // movzx   r13d, cl
};
CONST UCHAR _25h2_w11_KiDeliverApc_SIG[] = ///< For hook.
{
  0x45, 0x33, 0xdb,                         // xor      r11d, r11d
  0x49, 0x8b, 0xf8,						    // mov      rdi, r8
  0x4c, 0x89, 0x5d, 0xe0,				    // mov      qword ptr [rbp - 20h], r11
  0x44, 0x0f, 0xb6, 0xe9,				    // movzx    r13d, cl
  0x4c, 0x89, 0x5d, 0xe8, 				    // mov      qword ptr [rbp - 18h], r11
  0x4c, 0x89, 0x5d, 0xd8,				    // mov      qword ptr [rbp - 28h], r11
  0x4c, 0x89, 0x5d, 0x50,				    // mov      qword ptr [rbp + 50h], r11
  0x4d, 0x85, 0xc0						    // test     r8, r8
};
CONST UCHAR _25h2_w11_KiDeliverApc_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxxxxx" };


CONST UCHAR _25h2_w11_HandlerVsrExQueueWorkItem[] =
{
  0x48, 0xb8, 0x00, 0x00, 0x00, 0x00,       // mov     rax, 0FFFF800000000000h
  0x00, 0x80, 0xff, 0xff,
  0x4c, 0x3b, 0xc8,                         // cmp     r9, rax
};
CONST UCHAR _25h2_w11_ExQueueWorkItem_SIG[] = ///< For hook.
{
  0x48, 0xB8, 0x00, 0x00, 0x00, 0x00,       // mov     rax, 0FFFF800000000000h
  0x00, 0x80, 0xff, 0xff,
  0x4c, 0x3b, 0xc8                          // cmp     r9, rax
};
CONST UCHAR _25h2_w11_ExQueueWorkItem_MASK[] = { "xxxxxxxxxxxxx" };


CONST UCHAR _25h2_w11_HandlerVsrExAllocatePool2[] =
{
  0x48, 0x83, 0xc4, 0x10,                   // add     rsp, 010h
  0x41, 0x5f,                               // pop     r15
  0x41, 0x5e,                               // pop     r14 
  0x41, 0x5d,                               // pop     r13
  0x41, 0x5c,                               // pop     r12
  0x5f,                                     // pop     rdi
  0x5e,                                     // pop     rsi
  0x5d,                                     // pop     rbp
  0xc3                                      // ret
};
CONST UCHAR _25h2_w11_ExAllocatePool2_SIG[] = ///< For hook.
{
  0x41, 0x5f,                               // pop     r15
  0x41, 0x5e,                               // pop     r14 
  0x41, 0x5d,                               // pop     r13
  0x41, 0x5c,                               // pop     r12
  0x5f,                                     // pop     rdi
  0x5e,                                     // pop     rsi
  0x5d,                                     // pop     rbp
  0xc3                                      // ret
};
CONST UCHAR _25h2_w11_ExAllocatePool2_MASK[] = { "xxxxxxxxxxxx" };


CONST UCHAR _25h2_w11_HandlerVsrKiCustomRecurseRoutineX[] =
{
  0x48, 0x89, 0xc4,                         // mov     rsp,rax
  0xff, 0xe1,                               // jmp     rcx
  0xcc,                                     // int3
  0xcc,                                     // int3
  0xcc                                      // int3
};
CONST UCHAR _25h2_w11_KiCustomRecurseRoutineX_SIG[] = ///< For hook.
{
  0xff, 0xc9,                               // dec     ecx
  0x74, 0x00,                               // je      ntkrnlmp!KiCustomRecurseRoutineX+0xd 
  0xe8, 0xb3, 0xfa, 0xff, 0xff,             // call    ntkrnlmp!KiCustomRecurseRoutineX
  0x8b, 0x02,                               // mov     eax, dword ptr [rdx]
  0x48, 0x83, 0xc4, 0x28,                   // add     rsp, 28h
  0xc3,                                     // ret 
  0xcc,                                     // int 3
  0xcc,                                     // int 3
  0xcc                                      // int 3
};
CONST UCHAR _25h2_w11_KiCustomRecurseRoutineX_MASK[] = { "xxx?x????xxxxxxxxxx" };


CONST UCHAR _25h2_w11_KiBalanceSetManagerDeferredRoutine_SIG[] = ///< For fix.
{
  0x48, 0x8b, 0xc4, 0x48, 0x89,
  0x58, 0x08, 0x48, 0x89, 0x70,
  0x18, 0x48, 0x89, 0x78, 0x20,
  0x48, 0x89, 0x50, 0x10, 0x41,
  0x56, 0x48, 0x81, 0xec, 0x50,
  0x01, 0x00, 0x00, 0x48, 0x89,
  0xa4, 0x24, 0x40, 0x01, 0x00,
  0x00, 0x4d, 0x8b, 0xf1, 0x49,
  0x8b, 0xf0, 0x48, 0x8b, 0xda,
  0x48, 0x8b, 0xf9, 0x33, 0xd2,
  0x44, 0x8d, 0x42, 0x5f, 0x48,
  0x8d, 0x88, 0x38, 0xff, 0xff,
  0xff, 0x00, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_KiBalanceSetManagerDeferredRoutine_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx????" };


CONST UCHAR _25h2_w11_KiMcaDeferredRecoveryService_SIG[] = ///< For fix.
{
  0x33, 0xc0, 0x8b, 0xd8, 0x8b,
  0xf8, 0x8b, 0xe8, 0x4c, 0x8b,
  0xd0, 0x4c, 0x8b, 0xd8, 0x4c,
  0x8b, 0xe0, 0x4c, 0x8b, 0xe8,
  0x4c, 0x8b, 0xf0, 0x4c, 0x8b,
  0xf8, 0x00, 0x00, 0x00, 0x00,
};
CONST UCHAR _25h2_w11_KiMcaDeferredRecoveryService_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxx????" };


CONST UCHAR _25h2_w11_FsRtlUninitializeSmallMcb_SIG[] = ///< For fix.
{
 0x48, 0x83, 0xec, 0x48, 0xe8,
 0x00, 0x00, 0x00, 0x00, 0x48,
 0x8d, 0x88, 0x20, 0x08, 0x00,
 0x00, 0x48, 0x8b, 0x11, 0x48,
 0x0b, 0xd2, 0x75, 0x00, 0x48,
 0x83, 0xc4, 0x40, 0x53, 0x48,
 0x8b, 0xd0, 0x48, 0x8b, 0x88,
 0xe8, 0x07, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_FsRtlUninitializeSmallMcb_MASK[] = { "xxxxx????xxxxxxxxxxxxxx?xxxxxxxxxxxxxxx?" };


CONST UCHAR _25h2_w11_FsRtlTruncateSmallMcb_SIG[] = ///< For fix.
{
  0x48, 0x89, 0x5c, 0x24, 0x08,
  0x48, 0x89, 0x74, 0x24, 0x18,
  0x48, 0x89, 0x7c, 0x24, 0x20,
  0x41, 0x54, 0x41, 0x56, 0x41,
  0x57, 0x48, 0x81, 0xec, 0xa0,
  0x00, 0x00, 0x00, 0x4d, 0x8b,
  0xe1, 0x4d, 0x8b, 0xf0, 0x4c,
  0x8b, 0xfa, 0x48, 0x8B, 0xf1,
  0xe8, 0x00, 0x00, 0x00, 0x00,
  0x49, 0x8b, 0xc7, 0x48, 0xc1,
  0xf8, 0x2f, 0x48, 0xff, 0xc0,
  0x48, 0x83, 0xf8, 0x01, 0x0f,
  0x86, 0x00, 0x00, 0x00, 0x00,
  0x33, 0xff, 0x8b, 0xdf, 0x89,
  0x5c, 0x24, 0x20, 0x40, 0x88,
};
CONST UCHAR _25h2_w11_FsRtlTruncateSmallMcb_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx????xxxxxxxxxxxxxxxx????xxxxxxxxxx" };


CONST UCHAR _25h2_w11_KiDecodeMcaFault_SIG[] = ///< For fix.
{
  0x48, 0x89, 0x5c, 0x24, 0x08,
  0x48, 0x89, 0x74, 0x24, 0x10,
  0x57, 0x48, 0x83, 0xec, 0x20,
  0xe8, 0x00, 0x00, 0x00, 0x00,
  0x48, 0x8b, 0xd8, 0x48, 0x8d,
  0xb8, 0x20, 0x08, 0x00, 0x00,
  0x48, 0x8B, 0xcf, 0xe8, 0x00,
  0x00, 0x00, 0x00, 0x84, 0xc0,
  0x75, 0x16, 0x48, 0x8B, 0x83,
  0x80, 0x02, 0x00, 0x00, 0x33,
  0xd2, 0x48, 0x8b, 0xcf, 0xe8,
  0x00, 0x00, 0x00, 0x00, 0xe9,
  0x00, 0x00, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_KiDecodeMcaFault_MASK[] = { "xxxxxxxxxxxxxxxx????xxxxxxxxxxxxxx????xxxxxxxxxxxxxxxxx????x?????" };


CONST UCHAR _25h2_w11_CcBcbProfiler_SIG[] = ///< For fix.
{
  0x48, 0x89, 0x5c, 0x24, 0x08,
  0x48, 0x89, 0x6c, 0x24, 0x18,
  0x48, 0x89, 0x74, 0x24, 0x20,
  0x57, 0x41, 0x54, 0x41, 0x55,
  0x41, 0x56, 0x41, 0x57, 0x48,
  0x83, 0xec, 0x50, 0x48, 0x8b,
  0xf2, 0xe8, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_CcBcbProfiler_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx???" };


CONST UCHAR _25h2_w11_CcBcbProfiler2_SIG[] = ///< For fix.
{
  0x48, 0x89, 0x5C, 0x24, 0x18,
  0x55, 0x56, 0x57, 0x41, 0x54,
  0x41, 0x55, 0x41, 0x56, 0x41,
  0x57, 0x48, 0x83, 0xec, 0x50,
  0x48, 0x8b, 0xf1, 0xe8, 0x00,
  0x00, 0x00, 0x00, 0x44, 0x8b,
  0x86, 0x90, 0x00, 0x00, 0x00,
  0x4c, 0x8b, 0x96, 0x80, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_CcBcbProfiler2_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxx????xxxxxxxxxxxxx????" };


CONST UCHAR _25h2_w11_KiDispatchCallout_SIG[] = ///< For fix.
{
  0x48, 0x89, 0x5c, 0x24, 0x10,
  0x48, 0x89, 0x74, 0x24, 0x18,
  0x57, 0x48, 0x83, 0xec, 0x30,
  0x49, 0x8b, 0xd9, 0x48, 0x8b,
  0xf9, 0xe8, 0x00, 0x00, 0x00,
  0x00, 0x48, 0x8b, 0x1b, 0x48,
  0x8d, 0x74, 0x24, 0x38, 0x48,
  0x8b, 0xc3, 0x48, 0x33, 0x06,
  0x48, 0x33, 0xc7, 0x48, 0x89,
  0x47, 0x48, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_KiDispatchCallout_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxx????xxxxxxxxxxxxxxxxxxxxx???" };


CONST UCHAR _25h2_w11_MmAllocateIndependentPagesEx_SIG[] = ///< For using.
{
  0x44, 0x89, 0x4c, 0x24, 0x20,
  0x4c, 0x89, 0x44, 0x24, 0x18,
  0x53, 0x55, 0x57, 0x41, 0x54,
  0x41, 0x55, 0x41, 0x56, 0x41,
  0x57, 0x48, 0x83, 0xec, 0x60,
  0x48, 0xf7, 0xc1, 0xff, 0x0f,
  0x00, 0x00, 0xbd, 0x00, 0x00,
  0x00, 0x00, 0x8b, 0xfa, 0x0f,
  0x57, 0xc0, 0x40, 0x0f, 0x95,
  0xc5, 0x4d, 0x8b, 0xe8, 0x48,
  0xc1, 0xe9, 0x0c, 0x48, 0x03,
  0xe9, 0x00, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_MmAllocateIndependentPagesEx_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx????" };


CONST UCHAR _25h2_w11_MmFreeIndependentPages_SIG[] = ///< For using.
{
  0x48, 0x89, 0x5c, 0x24, 0x20,
  0x55, 0x56, 0x57, 0x41, 0x54,
  0x41, 0x55, 0x41, 0x56, 0x41,
  0x57, 0x48, 0x8b, 0xec, 0x48,
  0x83, 0xec, 0x60, 0x33, 0xc0,
  0x0f, 0x57, 0xc0, 0x44, 0x8b,
  0xf8, 0x48, 0x89, 0x45, 0xf0,
  0x48, 0xf7, 0xc2, 0xff, 0x0f,
  0x00, 0x00, 0x48, 0x8b, 0xf9,
  0x48, 0xb8, 0xf8, 0xff, 0xff,
  0xff, 0x7f, 0x00, 0x00, 0x00
};
CONST UCHAR _25h2_w11_MmFreeIndependentPages_MASK[] = { "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" };
